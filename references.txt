https://www.sunshine2k.de/reversing/tuts/tut_msg.htm
